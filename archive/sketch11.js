function init(){for(puzzle=["050790214","030010090","200004007","026509000","500030009","000208140","900400008","010070030","742085060"],m_grid=new Array(grid_l),c_grid=new Array(grid_l),col_set=new Array(grid_l),row_set=new Array(grid_l),sub_set=new Array(sub_l),begin=!1,complete=!1,msgBuff=[],msgIndex=0,solvedCount=0,i=0;i<grid_l;i++)col_set[i]={},row_set[i]={};for(i=0;i<sub_l;i++)for(sub_set[i]=new Array(sub_h),j=0;j<sub_h;j++)sub_set[i][j]={};for(i=0;i<grid_l;i++)for(m_grid[i]=new Array(grid_l),c_grid[i]=new Array(grid_l),j=0;j<grid_l;j++)m_grid[i][j]=puzzle[j][i],0!=puzzle[j][i]&&(col_set[i][puzzle[j][i]-1]=1,row_set[j][puzzle[j][i]-1]=1,sub_set[Math.floor(i/sub_l)][Math.floor(j/sub_h)][puzzle[j][i]-1]=1,solvedCount++),c_grid[i][j]={},c_grid[i][j].len=0;for(i=0;i<grid_l;i++)for(j=0;j<grid_l;j++)if(0==m_grid[i][j])for(k=0;k<grid_l;k++)1!=col_set[i][k]&&1!=row_set[j][k]&&1!=sub_set[Math.floor(i/sub_l)][Math.floor(j/sub_h)][k]&&1!=c_grid[i][j][k]&&(c_grid[i][j][k]=1,c_grid[i][j].len++)}function iterator(e,o){for(i=0;i<grid_l;i++)e([0,grid_l],[i,i+1],o[0]),e([i,i+1],[0,grid_l],o[0]);for(i=0;i<sub_l;i++)for(j=0;j<3;j++)e([j*sub_l,j*sub_l+sub_l],[i*sub_h,i*sub_h+sub_h],o[0])}function disjointSubsets(e,i,o){var t,s,r,l=[];for(t=e[0];t<e[1];t++)for(s=i[0];s<i[1];s++)c_grid[t][s].len>1&&c_grid[t][s].len<=o&&l.push([c_grid[t][s],t,s]);if(!(l.length<o)){var f=[],g=l.length;for(t=0;g>t;t++)f.push(t);var n=combinations(f,o);for(g=n.length,t=0;g>t;t++){var u={};for(s=0;o>s;s++){for(var d in l[n[t][s]][0])u[d]=l[n[t][s]][0][d];delete u.len}var a=0;for(var d in u)a++;if(a==o){for(s=0;o>s;s++);for(s=e[0];s<e[1];s++)for(r=i[0];r<i[1];r++){var c=!1,a=0;for(m=0;m<o;m++)s==l[n[t][m]][1]&&r==l[n[t][m]][2]&&(c=!0,a++);if(!c)for(var d in u)1==c_grid[s][r][d]&&(pushMessage("Candidate: "+d+" removed from at: "+s+", "+r),delete c_grid[s][r][d],c_grid[s][r].len--)}}}}}function pushMessage(e){void 0===msgBuff[0]&&msgBuff.push([e,255]),msgBuff[msgIndex]=[e,255],msgIndex++,msgIndex==2*msgColSize&&(msgIndex=0)}function writeSolution(e){for(i=0;i<grid_l;i++)if(1==c_grid[i][e].len){var o=parseInt(Object.keys(c_grid[i][e])[0]),t="Solution: "+(o+1)+" found at: "+i+", "+e;pushMessage(t);var s=Math.floor(i/sub_l)*sub_l,r=Math.floor(e/sub_h)*sub_h;for(m_grid[i][e]=o+1,delete c_grid[i][e][o],c_grid[i][e].len--,row_set[e][o]=1,col_set[i][o]=1,sub_set[Math.floor(i/sub_l)][Math.floor(e/sub_h)][o]=1,solvedCount++,ci=s;ci<s+sub_l;ci++)for(cj=r;cj<r+sub_h;cj++)1==c_grid[ci][cj][o]&&(delete c_grid[ci][cj][o],c_grid[ci][cj].len--);for(ci=0;ci<grid_l;ci++)1==c_grid[i][ci][o]&&(delete c_grid[i][ci][o],c_grid[i][ci].len--),1==c_grid[ci][e][o]&&(delete c_grid[ci][e][o],c_grid[ci][e].len--)}}function combinations(e,i){var o,t,s,r,l=[],f=e.length;for(o=0;f>o;o++)if(1===i)l.push([e[o]]);else for(s=combinations(e.slice(o+1,f),i-1),t=0;t<s.length;t++)r=s[t],r.unshift(e[o]),l.push(r);return l}function mouseClicked(){mouseX>=48&&mouseX<128&&mouseY>=8&&mouseY<36&&(init(),begin=!0),mouseX>=140&&mouseX<400&&mouseY>=8&&mouseY<36&&randomizeColours(),mouseX>=415&&mouseX<595&&mouseY>=8&&mouseY<36&&resetPuzzle()}function touchEnded(){touchX>=48&&touchX<128&&touchY>=8&&touchY<36&&(begin=!0),touchX>=140&&touchX<400&&touchY>=8&&touchY<36&&randomizeColours(),touchX>=415&&touchX<595&&touchY>=8&&touchY<36&&resetPuzzle()}function resetPuzzle(){init()}function randomizeColours(){for(i=0;i<3;i++)borderColour[i]=255*Math.random(),setColourA[i]=255*Math.random(),setColourB[i]=255*Math.random(),messageColour[i]=255*Math.random()}function getRandomColour(){var e=[];for(i=0;i<3;i++)e[i]=255*Math.random(),e[i]=255*Math.random(),e[i]=255*Math.random();return e}function compute(){writeSolution(solCount),solCount++,solCount==grid_l&&(solCount=0),iterator(disjointSubsets,[djCount]),djCount++,6==djCount&&(djCount=2)}function setup(){createCanvas(worldX,worldY),frameRate(worldSpeed),noLoop()}function draw(){for(background(25),textSize(gFontSize),fill(borderColour),stroke(borderColour),i=0;i<=grid_l;i++)line(i*gTileSize+gOffsetX,gOffsetY,i*gTileSize+gOffsetX,b1),line(gOffsetX,i*gTileSize+gOffsetY,b2,i*gTileSize+gOffsetY);for(fill(borderColour),stroke(borderColour),i=0;i<4;i++)line(3*i*gTileSize-1+gOffsetX,b5,3*i*gTileSize+b7,b3),line(3*i*gTileSize+1+gOffsetX,b5,3*i*gTileSize+b8,b3),line(b7,3*i*gTileSize+b5,b4,3*i*gTileSize+b5),line(b7,3*i*gTileSize+b6,b4,3*i*gTileSize+b6);for(i=0;i<grid_l;i++)for(j=0;j<grid_l;j++)text(m_grid[i][j],i*gTileSize+g1,j*gTileSize+g2);textSize(setsFontSize),fill(setColourA),stroke(setColourA);var e=0,o=0,t=0;for(i=0;i<grid_l;i++){for(j=0;j<grid_l;j++)1!=row_set[i][j]&&(text(j+1,s1+e*rSize,i*gTileSize+s2),e++),1!=col_set[i][j]&&(text(j+1,i*gTileSize+s3,s4+o*cSize),o++);e=0,o=0}for(fill(setColourB),stroke(setColourB),i=0;i<sub_l;i++)for(j=0;j<sub_h;j++){for(k=0;k<grid_l;k++)1!=sub_set[i][j][k]&&(text(k+1,sTopX+t%sub_l*s5+3*i*s6,sTopY+Math.floor(t/sub_h)*s7+3*j*s8),t++);t=0}fill(white),stroke(setColourB),textSize(btnFontSize),text("Begin",gOffsetX,35),text("Randomize Colours",gOffsetX+93,35),text("Reset Puzzle",gOffsetX+370,35),begin&&(compute(),81==solvedCount&&(complete=!0,begin=!1)),complete&&(textSize(50),text("SOLVED!",220,650),completedCount++,console.log(completedCount),init(),begin=!0),textSize(msgFontSize);var s=msgBuff.length;for(i=0;i<s;i++){var r=Math.floor(i/msgColSize),l=i%msgColSize;fill(messageColour[0],messageColour[1],messageColour[2],msgBuff[i][1]),stroke(messageColour[0],messageColour[1],messageColour[2],msgBuff[i][1]),text(msgBuff[i][0],msgOffsetX+340*r,m1+l*m2),msgBuff[i][1]-=msgFade}}var worldX=1920,worldY=980,worldSpeed=10,completedCount=0,msgBuff=[],msgIndex=0,msgColSize=36,msgFontSize=20,msgFade=10,msgOffsetX=850,msgOffsetY=gOffsetX+15,gTileSize=60,gOffsetX=50,gOffsetY=50,gFontSize=50,gFontOffsetX=18,gFontOffsetY=48,setsFontSize=38,rOffset=70,cOffset=108,rSize=28,cSize=42,rFontY=-3,cFontX=1,sSize=20,sTopX=9*gTileSize+rOffset,sTopY=9*gTileSize+cOffset,sGapX=6,sGapY=19,sSpaceX=2,sSpaceY=13,grid_l=9,sub_l=3,sub_h=3,solvedCount=0,borderColour=[255*Math.random(),255*Math.random(),255*Math.random()],puzzleColour=[255*Math.random(),255*Math.random(),255*Math.random()],setColourA=[255*Math.random(),255*Math.random(),255*Math.random()],setColourB=[255*Math.random(),255*Math.random(),255*Math.random()],messageColour=[255*Math.random(),255*Math.random(),255*Math.random()],white=255,puzzle,m_grid,c_grid,col_set,row_set,sub_set,begin,complete,btnFontSize=29,solCount=0,djCount=2,b1=9*gTileSize+gOffsetY,b2=9*gTileSize+gOffsetX,b3=9*gTileSize+gOffsetY+1,b4=9*gTileSize+gOffsetX+1,b5=gOffsetY-1,b6=gOffsetY+1,b7=gOffsetX-1,b8=gOffsetX+1,g1=gFontOffsetX+gOffsetX,g2=gFontOffsetY+gOffsetY,s1=9*gTileSize+rOffset,s2=gFontOffsetY+gOffsetY+rFontY,s3=gFontOffsetX+gOffsetX+cFontX,s4=9*gTileSize+cOffset,s5=sSize+sSpaceX,s6=sSize+sGapX,s7=sSize+sSpaceY,s8=sSize+sGapY,m1=gOffsetX+15,m2=msgFontSize+5;init();var d=new Date;for(console.log(d.getTime()),t=0;t<1e3;t++){for(;!complete;)compute(),81==solvedCount&&(complete=!0);complete&&(completedCount++,init())}d=new Date,console.log(d.getTime());